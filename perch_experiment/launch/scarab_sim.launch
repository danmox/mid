<launch>

  <arg name="id"/>
  <arg name="spawn_x" default="0.0"/>
  <arg name="spawn_y" default="0.0"/>
  <arg name="spawn_z" default="0.0"/>
  <arg name="camera"  default="false"/>
  <arg name="hokuyo"  default="true"/>
  <arg name="type"    default="none"/>
  <arg name="agent"   default="scarab$(arg id)"/>
  <arg name="gdb"     default="false"/>

  <include file="$(find scarab)/launch/scarab_sim.launch">
    <arg name="agent"     value="$(arg agent)"/>
    <arg name="spawn_x"   value="$(arg spawn_x)"/>
    <arg name="spawn_y"   value="$(arg spawn_y)"/>
    <arg name="spawn_z"   value="$(arg spawn_z)"/>
    <arg name="camera"    value="$(arg camera)"/>
    <arg name="hokuyo"    value="$(arg hokuyo)"/>
    <arg name="map_xmin"  value="-30.0"/>
    <arg name="map_xmax"  value="30.0"/>
    <arg name="map_ymin"  value="-15.0"/>
    <arg name="map_ymax"  value="15.0"/>
  </include>

  <arg name="task" value="true" if="$(eval arg('type') == 'task')"/>
  <arg name="task" value="false" unless="$(eval arg('type') == 'task')"/>
  <arg name="mid"  value="true" if="$(eval arg('type') == 'mid')"/>
  <arg name="mid"  value="false" unless="$(eval arg('type') == 'mid')"/>

  <arg name="launch_prefix" value="alacritty -e gdb --args" if="$(arg gdb)"/>
  <arg name="launch_prefix" value="" unless="$(arg gdb)"/>

  <group ns="$(arg agent)">

    <node name="frontier_exploration_node"
          pkg="frontier_exploration"
          type="frontier_exploration"
          output="screen"
          launch-prefix="$(arg launch_prefix)"
          if="$(arg task)">
      <param name="map_frame_id" value="$(arg agent)/map" />
    </node>

    <node name="mid_planner"
          pkg="or_planner"
          type="or_planner_node"
          output="screen"
          launch-prefix="$(arg launch_prefix)"
          if="$(arg mid)">
      <param name="robot_type"   value="$(arg type)"/>
      <param name="node_id"      value="$(arg id)"/>
      <param name="v_max"        value="0.5"/>   <!-- m/s -->
      <param name="w_max"        value="1.0"/>   <!-- rad/s -->
      <param name="heading_tol"  value="0.25"/>  <!-- ~15 deg -->
      <param name="position_tol" value="0.25"/>  <!-- m -->
      <remap from="status" to="/network_state"/>
    </node>

  </group>

</launch>
